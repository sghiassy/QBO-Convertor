/*! qbo-converter - v0.0.1 - 2013-12-28
* Copyright (c) 2013 ; Licensed  */
function download(a,b){var c=document.createElement("a");c.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(b)),c.setAttribute("download",a),c.click()}window.app={css:{}},$(document).ready(function(){app.setupCSS(),app.setupFileAPI()}),app.changeFileExtension=function(a){if(a.split(".").length>=3||"string"!=typeof a)throw"Error 3XS: Improper filename argument";var b=a.split(".")[0],c=b+".qbo";return c},app.convertFile=function(a){var b="<ORG>",c="<FID>",d="</FI>",e="<INTU.BID>",f="</SONRS>",g="AMEX",h="3106",i="3106",j=a.search(b),k=a.search(c);a=a.substring(0,j+b.length)+g+a.substring(k,a.length);var k=a.search(c),l=a.search(d);a=a.substring(0,k+c.length)+h+a.substring(l,a.length);var m=a.search(e),n=a.search(f);return a=a.substring(0,m+e.length)+i+a.substring(n,a.length)},app.handleFileSelect=function(a){a.stopPropagation(),a.preventDefault();for(var b,c=a.dataTransfer.files,d=0;b=c[d];d++)if("qfx"===app.getFileExtension(b.name)){window.fileName=b.name,app.infoSign.newMessage(b.name);var e=new FileReader;e.onload=function(){return function(a){var b=app.convertFile(a.target.result);app.infoSign.newMessage("You're conversion was successful. Your file will be downloaded."),download(app.changeFileExtension(window.fileName),b)}}(b),e.readAsText(b)}else app.infoSign.newMessage("This app currently only supports converting QFX files")},app.getFileExtension=function(a){return fileExtension=a.split(".")[a.split(".").length-1]},app.resizeWindow=function(){app.css.windowHeight=$(window).height(),app.css.windowWidth=$(window).width(),app.css.$wrapper.css({height:app.css.windowHeight}),formLeft=app.css.windowWidth/2-app.css.$inputForm.width()/2},app.handleDragOver=function(a){a.stopPropagation(),a.preventDefault(),a.dataTransfer.dropEffect="copy"},app.setupFileAPI=function(){if(window.File&&window.FileReader&&window.FileList&&window.Blob){var a=document.getElementById("input-form");a.addEventListener("dragover",app.handleDragOver,!1),a.addEventListener("drop",app.handleFileSelect,!1)}else alert("The File APIs are not fully supported in this browser.")},app.setupCSS=function(){app.css.$wrapper=$("#wrapper"),app.css.$inputForm=$("#input-form"),app.css.$infoSign=$("#info-sign"),app.resizeWindow(),$(window).resize(function(){app.resizeWindow()}),app.css.$infoSign.css({top:"77px"}),$("body").click(function(){app.infoSign.close()})},app.infoSign={},app.infoSign.newMessage=function(a){app.css.$infoSign.html(a),app.css.$infoSign.animate({top:"0px",zIndex:1},500,function(){})},app.infoSign.close=function(){app.css.$infoSign.css({zIndex:-1}),app.css.$infoSign.animate({top:"77px"},500,function(){})};